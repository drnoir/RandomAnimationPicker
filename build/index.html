<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bouncing Ball with Random Animation Type</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>

  </head>
  <body>
    <a-scene>
        <a-assets>
            <img id="sky" src="sky.jpg">
          </a-assets>
          <a-sky src="#sky"></a-sky>
            <!-- Autoplaying background music -->
      <a-entity sound="src: url(music.mp3); autoplay: true; loop: true; volume: 0.5"></a-entity>
      <!-- Bouncing ball -->
      <a-entity id="ball" geometry="primitive: sphere; radius: 0.5" 
                material="src: url(ball.jpg)" 
                color="#fff" 
                position="-2 -1 -3"
                animation="property: position; to: -2 2 -3; dir: alternate; loop: true; dur: 1000; easing: easeInOutSine">
      </a-entity>

      <!-- Button that triggers the random animation text -->
      <a-box id="button" 
           material="src: url(btn.jpg)" 
           color="#fff" 
             position="0 1.5 -3" 
             depth="0.2" height="0.2" width="1" 
             class="clickable">
             <a-text id="BtnClick" value="Press" color="#fff"  position="-0.6 0 0.2"></a-text>
      </a-box>
      <a-box color="#fff"  material="src: url(btn.jpg)"  position="0 2 -3"  depth="0.2" height="0.5" width="1.5"  >
      <!-- Text that shows the animation type -->
      <a-text id="animationText" value="Look" color="#fff"  position="-0.6 0 0.2"></a-text>
      </a-box> 
      <!-- Gaze Cursor -->
      <a-entity camera look-controls>
        <a-cursor fuse="true" fuse-timeout="1500"
                  position="0 0 -1" 
                  geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                  material="color: black; shader: flat"
                  raycaster="objects: .clickable">
        </a-cursor>
      </a-entity>

      <!-- Light -->
      <a-light type="ambient" color="#FFF"></a-light>

      <!-- Script to handle the random selection and pulsing ball -->
      <script>
        // JSON list of animation types
        const animationTypes = ['Stop Motion', '3D', 'Flickbook', '2D', 'Rotoscoping', 'CGI'];

        // Function to get a random animation type
        function getRandomAnimationType() {
          const randomIndex = Math.floor(Math.random() * animationTypes.length);
          return animationTypes[randomIndex];
        }

        // Handle the gaze cursor event on the button
        AFRAME.registerComponent('gaze-listener', {
          init: function () {
            const ball = document.querySelector('#ball');
            const animationText = document.querySelector('#animationText');

            this.el.addEventListener('fusing', function () {
              // Get random animation type
              const randomType = getRandomAnimationType();
              animationText.setAttribute('value', randomType);

              // Pulse the ball
              ball.setAttribute('animation__pulse', {
                property: 'scale',
                to: '1.2 1.2 1.2',
                dir: 'alternate',
                dur: 200,
                loop: 2
              });
            });
          }
        });

        // Add gaze-listener to the button entity
        document.querySelector('#button').setAttribute('gaze-listener', '');
      </script>
    </a-scene>
  </body>
</html>
